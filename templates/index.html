<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Prediksi Performa Matematika Mahasiswa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }
        body {
            background: #f8f9fa;
        }
        .navbar {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 0;
        }
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
        }
        .hero-section {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 60px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .card {
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            border: none;
            border-radius: 12px;
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 25px rgba(0,0,0,0.15);
        }
        .card-header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            font-weight: 600;
            padding: 20px;
            border-radius: 12px 12px 0 0 !important;
        }
        .form-label {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        .form-control, .form-select {
            border-radius: 8px;
            border: 1.5px solid #e0e0e0;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }
        .form-control:focus, .form-select:focus {
            border-color: #2c3e50;
            box-shadow: 0 0 0 3px rgba(44, 62, 80, 0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border: none;
            border-radius: 8px;
            padding: 14px 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(44, 62, 80, 0.3);
        }
        .btn-outline-secondary {
            border-radius: 8px;
            padding: 8px 20px;
            font-weight: 500;
        }
        .result-card {
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .high-performance {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }
        .low-performance {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }
        .loading {
            display: none;
        }
        .spinner-border {
            width: 1rem;
            height: 1rem;
        }
        .info-section {
            background: #ffffff;
            border-left: 4px solid #2c3e50;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }
        .stat-card {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .stat-card i {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-graduation-cap me-2"></i>
                Prediksi Performa Matematika
            </a>
            <div class="ms-auto">
                <a href="/graphs" class="btn btn-light btn-sm">
                    <i class="fas fa-chart-bar me-1"></i>
                    Grafik Analisis
                </a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 mx-auto text-center">
                    <h1 class="display-5 fw-bold mb-3">
                        Sistem Prediksi Performa Matematika Mahasiswa
                    </h1>
                    <p class="lead mb-4">
                        Prediksi performa matematika mahasiswa menggunakan Machine Learning<br>
                        Berbasis Decision Tree dengan akurasi 82.5%
                    </p>
                    <div class="row mt-4">
                        <div class="col-md-4">
                            <div class="stat-card">
                                <i class="fas fa-brain"></i>
                                <h6 class="fw-bold">Ditenagai AI</h6>
                                <p class="text-muted mb-0 small">Pembelajaran Mesin</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card">
                                <i class="fas fa-calculator"></i>
                                <h6 class="fw-bold">7 Fitur Input</h6>
                                <p class="text-muted mb-0 small">Jenis Kelamin, Ras, Pendidikan, dll.</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card">
                                <i class="fas fa-chart-line"></i>
                                <h6 class="fw-bold">Akurasi Tinggi</h6>
                                <p class="text-muted mb-0 small">82.5% Akurasi</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container my-5">
        <div class="row justify-content-center">
            <!-- Single Prediction Form -->
            <div class="col-lg-9">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">
                            <i class="fas fa-user-graduate me-2"></i>
                            Form Prediksi Performa Matematika
                        </h4>
                    </div>
                    <div class="card-body">
                        <form id="singleForm">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="gender" class="form-label">Jenis Kelamin</label>
                                    <select class="form-select" id="gender" name="gender" required>
                                        <option value="">Pilih</option>
                                        <option value="female">Perempuan</option>
                                        <option value="male">Laki-laki</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="race_ethnicity" class="form-label">Kelompok Etnis</label>
                                    <select class="form-select" id="race_ethnicity" name="race_ethnicity" required>
                                        <option value="">Pilih</option>
                                        <option value="group A">Kelompok A</option>
                                        <option value="group B">Kelompok B</option>
                                        <option value="group C">Kelompok C</option>
                                        <option value="group D">Kelompok D</option>
                                        <option value="group E">Kelompok E</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="parental_education" class="form-label">Pendidikan Orang Tua</label>
                                    <select class="form-select" id="parental_education" name="parental_education" required>
                                        <option value="">Pilih</option>
                                        <option value="associate's degree">Diploma</option>
                                        <option value="bachelor's degree">Sarjana</option>
                                        <option value="high school">SMA</option>
                                        <option value="master's degree">Magister</option>
                                        <option value="some college">Perguruan Tinggi (tidak selesai)</option>
                                        <option value="some high school">SMA (tidak selesai)</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="lunch" class="form-label">Status Ekonomi</label>
                                    <select class="form-select" id="lunch" name="lunch" required>
                                        <option value="">Pilih</option>
                                        <option value="free/reduced">Mendapat Bantuan</option>
                                        <option value="standard">Tanpa Bantuan</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="test_preparation" class="form-label">Kursus Persiapan Ujian</label>
                                    <select class="form-select" id="test_preparation" name="test_preparation" required>
                                        <option value="">Pilih</option>
                                        <option value="completed">Sudah Mengerjakan</option>
                                        <option value="none">Belum Mengerjakan</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="reading_score" class="form-label">Nilai Membaca</label>
                                    <input type="number" class="form-control" id="reading_score" name="reading_score" min="0" max="100" value="75" required>
                                    <small class="form-text text-muted">0-100</small>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="writing_score" class="form-label">Nilai Menulis</label>
                                    <input type="number" class="form-control" id="writing_score" name="writing_score" min="0" max="100" value="75" required>
                                    <small class="form-text text-muted">0-100</small>
                                </div>
                            </div>
                            
                            <!-- Auto-fill button -->
                            <div class="mb-4">
                                <button type="button" class="btn btn-outline-secondary" onclick="fillSampleData()">
                                    <i class="fas fa-magic me-2"></i>
                                    Isi Data Contoh
                                </button>
                                <small class="text-muted ms-2">Klik untuk mengisi data contoh</small>
                            </div>
                            
                            <button type="submit" class="btn btn-primary w-100">
                                <span class="loading">
                                    <span class="spinner-border spinner-border-sm me-2"></span>
                                    Memproses...
                                </span>
                                <span class="normal-text">
                                    <i class="fas fa-search me-2"></i>
                                    Prediksi Performa
                                </span>
                            </button>
                        </form>
                        
                        <!-- Result -->
                        <div id="singleResult" class="result-card" style="display: none;">
                            <h5 class="mb-3">
                                <i class="fas fa-chart-bar me-2"></i>
                                Hasil Prediksi
                            </h5>
                            <div id="singleResultContent"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Information Section -->
        <div class="row mt-5">
            <div class="col-lg-12">
                <div class="info-section">
                    <h5 class="fw-bold mb-3">
                        <i class="fas fa-info-circle me-2"></i>
                        Informasi Model
                    </h5>
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="fw-bold">Variabel Target:</h6>
                            <ul class="mb-0">
                                <li><strong>Performansi Tinggi:</strong> Nilai Matematika ≥ 70</li>
                                <li><strong>Performansi Rendah:</strong> Nilai Matematika < 70</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="fw-bold">Fitur yang Digunakan:</h6>
                            <ul class="mb-0">
                                <li>Jenis Kelamin</li>
                                <li>Kelompok Etnis</li>
                                <li>Pendidikan Orang Tua</li>
                                <li>Status Ekonomi</li>
                                <li>Kursus Persiapan Ujian</li>
                                <li>Nilai Membaca</li>
                                <li>Nilai Menulis</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Single prediction form
        document.getElementById('singleForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            
            // Show loading
            const submitBtn = this.querySelector('button[type="submit"]');
            submitBtn.querySelector('.loading').style.display = 'inline';
            submitBtn.querySelector('.normal-text').style.display = 'none';
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    displaySingleResult(result);
                } else {
                    alert('Terjadi Kesalahan: ' + result.error);
                }
            } catch (error) {
                alert('Terjadi Kesalahan: ' + error.message);
            } finally {
                // Hide loading
                submitBtn.querySelector('.loading').style.display = 'none';
                submitBtn.querySelector('.normal-text').style.display = 'inline';
                submitBtn.disabled = false;
            }
        });
        
        function displaySingleResult(result) {
            const resultDiv = document.getElementById('singleResult');
            const contentDiv = document.getElementById('singleResultContent');
            
            const isHighPerformance = result.prediction === 1;
            const statusClass = isHighPerformance ? 'high-performance' : 'low-performance';
            const statusIcon = isHighPerformance ? 'fas fa-trophy' : 'fas fa-exclamation-triangle';
            const statusText = isHighPerformance ? 'PERFORMA TINGGI!' : 'PERFORMA RENDAH';
            
            contentDiv.innerHTML = `
                <div class="card ${statusClass}">
                    <div class="card-body text-center">
                        <i class="${statusIcon} fa-4x mb-3"></i>
                        <h3 class="mb-3">${statusText}</h3>
                        <p class="mb-4 fs-5">${result.description}</p>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Probabilitas Performa Tinggi</h5>
                                <h2>${(result.probability_high * 100).toFixed(2)}%</h2>
                            </div>
                            <div class="col-md-6">
                                <h5>Probabilitas Performa Rendah</h5>
                                <h2>${(result.probability_low * 100).toFixed(2)}%</h2>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            resultDiv.style.display = 'block';
        }
        
        // Function untuk auto-fill sample data
        function fillSampleData() {
            // Sample data untuk mahasiswa dengan performa tinggi
            const sampleData = {
                gender: 'female',
                race_ethnicity: 'group B',
                parental_education: "bachelor's degree",
                lunch: 'standard',
                test_preparation: 'completed',
                reading_score: 85,
                writing_score: 88
            };
            
            // Fill form dengan sample data
            Object.keys(sampleData).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = sampleData[key];
                }
            });
            
            // Show success message
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check me-2"></i>Data Terisi!';
            button.classList.remove('btn-outline-secondary');
            button.classList.add('btn-success');
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('btn-success');
                button.classList.add('btn-outline-secondary');
            }, 2000);
        }
    </script>
</body>
</html>